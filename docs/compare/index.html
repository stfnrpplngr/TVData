<!doctype html>
<html lang="de">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tarifvergleich – TVData</title>
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <div class="bg-orb orb-a"></div>
    <div class="bg-orb orb-b"></div>
    <div class="bg-orb orb-c"></div>

    <div class="app-shell">
      <header class="topbar panel glass">
        <div class="brand">
          <p class="eyebrow">TVData • Verhandlungs-Analytics</p>
          <h1>Shiny Tarif Dashboard</h1>
          <p class="muted">Tarifvergleiche für Verhandlung, Transparenz und Governance.</p>
        </div>
        <label>
          Tarif A
          <select id="tariffASelect"></select>
        </label>
        <label>
          Tarif B
          <select id="tariffBSelect"></select>
        </label>
        <div class="meta-block">
          <div id="validityInfo" class="meta-line">Gültigkeitsstand: —</div>
          <div id="versionInfo" class="meta-line">Version: —</div>
        </div>
        <div class="export-row">
          <button id="exportCsv">CSV</button>
          <button id="exportExcel">Excel</button>
          <button id="exportPng">PNG</button>
        </div>
      </header>

      <aside class="sidebar panel glass">
        <h2>Filter & Logik</h2>
        <label>Entgeltgruppe von <input id="groupFrom" type="number" min="1" value="1" /></label>
        <label>Entgeltgruppe bis <input id="groupTo" type="number" min="1" value="15" /></label>
        <label>Stufe von <input id="stepFrom" type="number" min="1" value="1" /></label>
        <label>Stufe bis <input id="stepTo" type="number" min="1" value="6" /></label>
        <label>
          Referenz
          <select id="referenceMode">
            <option value="A_MINUS_B">Differenz = A minus B</option>
            <option value="B_MINUS_A">Differenz = B minus A</option>
          </select>
        </label>
        <label>
          Nur ausgewählte EGs (Komma getrennt)
          <input id="selectedGroups" type="text" placeholder="z. B. 9,10,11" />
        </label>

        <fieldset>
          <legend>Komponenten</legend>
          <label><input type="checkbox" id="includeBase" checked /> Grundentgelt</label>
          <label><input type="checkbox" id="includeJsz" checked /> Jahressonderzahlung</label>
          <label><input type="checkbox" id="includeVwl" checked /> VWL</label>
          <label><input type="checkbox" id="includeAllowances" checked /> Zulagen</label>
        </fieldset>

        <label>
          Zeitlogik
          <select id="timeMode">
            <option value="standard">Stufenlaufzeiten Standard</option>
            <option value="tariff">Stufenlaufzeiten Tarif-spezifisch</option>
            <option value="custom">Eigener Laufzeitenmodus</option>
          </select>
        </label>
        <label>
          Eigene Laufzeit pro Stufe (Jahre)
          <input id="customDuration" type="number" min="0.5" step="0.5" value="2" />
        </label>

        <label><input type="checkbox" id="argumentMode" /> Argumentationsmodus</label>
        <button id="applyBtn">Dashboard aktualisieren</button>
      </aside>

      <main class="content">
        <section class="panel glass" id="overviewSection">
          <div class="section-head">
            <h2>Ansicht A: Überblick</h2>
            <span class="chip">Top-Level Vergleich</span>
          </div>
          <div id="kpiTiles" class="cards"></div>
          <div id="curvePlot" class="chart-wrap"></div>
          <div id="differenceBand" class="chart-wrap"></div>
        </section>

        <section class="panel glass" id="detailSection">
          <div class="section-head">
            <h2>Ansicht B: Detailvergleich Entgeltgruppe</h2>
            <span class="chip">Deep Dive</span>
          </div>
          <label>Fokus EG <select id="detailGroupSelect"></select></label>
          <div id="detailTable"></div>
          <div id="microChart" class="chart-wrap"></div>
          <div id="detailHoverInfo" class="muted">Hover über eine Tabellenzelle für Rundung/Stufenlaufzeit/Jahresbrutto.</div>
        </section>

        <section class="panel glass" id="heatmapSection">
          <div class="section-head">
            <h2>Ansicht C: Heatmap Vergleich aller EGs</h2>
            <span class="chip">Pattern Scan</span>
          </div>
          <label>
            Darstellung
            <select id="heatmapMode">
              <option value="abs">Absolute Differenzen</option>
              <option value="rel">Prozentdifferenzen</option>
            </select>
          </label>
          <div id="heatmap"></div>
        </section>

        <section class="panel glass" id="simSection">
          <div class="section-head">
            <h2>Ansicht D: Jahres- und Lebensverdienst Rechner</h2>
            <span class="chip">Simulation</span>
          </div>
          <div class="sim-grid">
            <label>EG <select id="simGroup"></select></label>
            <label>Startstufe <input id="simStartStep" type="number" min="1" value="1" /></label>
            <label>Laufzeit (Jahre) <input id="simYears" type="number" min="1" value="15" /></label>
            <label>Jahresarbeitszeitfaktor <input id="simWorkFactor" type="number" min="0.1" step="0.1" value="1" /></label>
          </div>
          <div id="lifetimeChart" class="chart-wrap"></div>
          <div id="lifetimeTable"></div>
        </section>

        <section class="panel glass" id="sourceSection">
          <div class="section-head">
            <h2>Ansicht E: Quellen & Änderungslog</h2>
            <span class="chip">Governance</span>
          </div>
          <div id="sources"></div>
          <div id="governance"></div>
        </section>
      </main>
    </div>

    <script type="module" src="./app-main.js?v=20260220a"></script>
  </body>
</html>
